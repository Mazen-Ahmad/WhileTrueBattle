{
  "contestId": 1889,
  "index": "F",
  "name": "Doremy's Average Tree",
  "rating": 3500,
  "tags": [
    "implementation"
  ],
  "statement": "Doremy has a rooted tree of size $$$n$$$ whose root is vertex $$$r$$$. Initially there is a number $$$w_i$$$ written on vertex $$$i$$$. Doremy can use her power to perform this operation at most $$$k$$$ times: Choose a vertex $$$x$$$ ($$$1 \\leq x \\leq n$$$). Let $$$s = \\frac{1}{|T|}\\sum_{i \\in T} w_i$$$ where $$$T$$$ is the set of all vertices in $$$x$$$'s subtree. For all $$$i \\in T$$$, assign $$$w_i := s$$$. Doremy wants to know what is the lexicographically smallest$$$^\\dagger$$$ array $$$w$$$ after performing all the operations. Can you help her? If there are multiple answers, you may output any one. $$$^\\dagger$$$ For arrays $$$a$$$ and $$$b$$$ both of length $$$n$$$, $$$a$$$ is lexicographically smaller than $$$b$$$ if and only if there exist an index $$$i$$$ ($$$1 \\leq i \\le n$$$) such that $$$a_i < b_i$$$ and for all indices $$$j$$$ such that $$$j<i$$$, $$$a_j=b_j$$$ is satisfied.",
  "inputFormat": "The input consists of multiple test cases. The first line contains a single integer $$$t$$$ ($$$1\\le t\\le 10^4$$$) — the number of test cases. The description of the test cases follows. The first line contains three integers $$$n$$$, $$$r$$$, $$$k$$$ ($$$2 \\le n \\le 5000$$$, $$$1 \\le r \\le n$$$, $$$0 \\le k \\le \\min(500,n)$$$). The second line contains $$$n$$$ integers $$$w_1,w_2,\\ldots,w_n$$$ ($$$1 \\le w_i \\le 10^6$$$). Each of the next $$$n-1$$$ lines contains two integers $$$u_i$$$, $$$v_i$$$ ($$$1 \\leq u_i, v_i \\leq n$$$), representing an edge between $$$u_i$$$ and $$$v_i$$$. It is guaranteed that the given edges form a tree. It is guaranteed that the sum of $$$n$$$ does not exceed $$$50\\,000$$$.",
  "outputFormat": "For each test case, In the first line, output a single integer $$$cnt$$$ ($$$0 \\le cnt \\le k$$$) — the number of operations you perform. Then, in the second line output $$$cnt$$$ integers $$$p_1,p_2,\\ldots,p_{cnt}$$$ — $$$x$$$ is chosen to be $$$p_i$$$ for $$$i$$$-th operation. If there are multiple answers, you may output any one.",
  "sampleTests": [
    {
      "input": "4\n6 1 1\n1 9 2 6 1 8\n1 2\n1 3\n2 4\n3 6\n3 5\n7 7 2\n3 1 3 3 1 1 2\n7 1\n7 2\n7 4\n1 5\n2 3\n4 6\n6 5 1\n3 1 3 1 1 3\n5 3\n5 1\n5 6\n3 4\n1 2\n3 2 1\n1000000 999999 999997\n2 1\n1 3",
      "output": "1\n2\n2\n1 4\n1\n5\n1\n1"
    }
  ],
  "timeLimit": 3000,
  "memoryLimit": 1024,
  "sourceUrl": "https://codeforces.com/problemset/problem/1889/F",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}