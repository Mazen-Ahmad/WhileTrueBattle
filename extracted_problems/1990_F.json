{
  "contestId": 1990,
  "index": "F",
  "name": "Polygonal Segments",
  "rating": 2800,
  "tags": [
    "implementation"
  ],
  "statement": "You are given an array $$$a$$$ of size $$$n$$$. A segment $$$[l, r](1 \\le l < r \\le n)$$$ is called a polygonal segment only if the following conditions hold: $$$(r-l+1) \\geq 3$$$; Considering $$$a_l, a_{l+1}, \\ldots, a_r$$$ as side lengths, these sides can form a polygon with $$$(r-l+1)$$$ sides. Process $$$q$$$ queries of two types: \" 1 l r \": find the length of the longest segment among all polygonal segments $$$[l_0,r_0]$$$ satisfying $$$l \\le l_0 \\le r_0 \\le r$$$. If there is no such polygonal segment, output $$$-1$$$ instead; \" 2 i x \": assign $$$a_i := x$$$.",
  "inputFormat": "The first line contains an integer $$$t$$$ ($$$1 \\leq t \\leq 10^4$$$) â€” the number of test cases. For each test case: The first line of each testcase contains two integers $$$n$$$, $$$q$$$ ($$$4 \\le n \\le 2\\cdot 10^5$$$, $$$1 \\le q \\le 10^5$$$); The second line of each testcase contains $$$n$$$ integers $$$a_1,a_2,\\ldots, a_n$$$ ($$$1 \\le a_i \\le 10^{12}$$$); The following $$$q$$$ lines contain the description of queries. Each line is of one of two types: \" 1 l r \" ($$$1 \\le l < r \\le n$$$, $$$r-l+1\\ge 3$$$); \" 2 i x \" ($$$1 \\le i \\le n$$$, $$$1 \\le x \\le 10^{12}$$$). It is guaranteed that the sum of $$$n$$$ over all test cases will not exceed $$$2 \\cdot 10^5$$$, and the sum of $$$q$$$ over all test cases will not exceed $$$10^5$$$.",
  "outputFormat": "For each query, if there is no suitable segment, output $$$-1$$$ in a new line. Otherwise, output the length of the longest segment satisfying the condition above in a new line.",
  "sampleTests": [
    {
      "input": "2\n5 6\n3 1 2 2 8\n1 1 3\n1 1 4\n1 1 5\n2 1 5\n1 1 4\n1 1 5\n4 10\n500000000000 500000000000 1000000000000 500000000000\n1 1 3\n1 2 4\n1 1 4\n2 1 499999999999\n2 3 999999999999\n1 1 3\n1 2 4\n1 1 4\n2 3 1000000000000\n1 1 3",
      "output": "-1\n4\n4\n3\n5\n-1\n-1\n4\n-1\n3\n4\n-1"
    }
  ],
  "timeLimit": 8000,
  "memoryLimit": 512,
  "sourceUrl": "https://codeforces.com/problemset/problem/1990/F",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}