{
  "contestId": 1797,
  "index": "E",
  "name": "Li Hua and Array",
  "rating": 2300,
  "tags": [
    "implementation"
  ],
  "statement": "Li Hua wants to solve a problem about $$$\\varphi$$$ — Euler's totient function. Please recall that $$$\\varphi(x)=\\sum\\limits_{i=1}^x[\\gcd(i,x)=1]$$$.$$$^{\\dagger,\\ddagger}$$$ He has a sequence $$$a_1,a_2,\\cdots,a_n$$$ and he wants to perform $$$m$$$ operations: \"1 $$$l$$$ $$$r$$$\" ($$$1\\le l\\le r\\le n$$$) — for each $$$x\\in[l,r]$$$, change $$$a_x$$$ into $$$\\varphi(a_x)$$$. \"2 $$$l$$$ $$$r$$$\" ($$$1\\le l\\le r\\le n$$$) — find out the minimum changes needed to make sure $$$a_l=a_{l+1}=\\cdots=a_r$$$. In each change, he chooses one $$$x\\in[l,r]$$$, change $$$a_x$$$ into $$$\\varphi(a_x)$$$. Each operation of this type is independent, which means the array doesn't actually change. Suppose you were Li Hua, please solve this problem. $$$^\\dagger$$$ $$$\\gcd(x,y)$$$ denotes the greatest common divisor (GCD) of integers $$$x$$$ and $$$y$$$. $$$^\\ddagger$$$ The notation $$$[\\textrm{cond}]$$$ equals $$$1$$$ if the condition $$$\\textrm{cond}$$$ is true, and $$$0$$$ otherwise.",
  "inputFormat": "The first line contains two integers $$$n$$$ and $$$m$$$ ($$$1\\le n,m\\le 10^{5}$$$) — the number of elements in the array and the number of operations to process, respectively. The second line contains $$$n$$$ integers $$$a_{1},a_{2},\\cdots ,a_{n}$$$ ($$$1\\le a_{i}\\le 5\\cdot 10^{6}$$$) — the elements of the array. Next $$$m$$$ lines, each line contains three integers $$$t_{i},l_{i},r_{i}$$$ ($$$t_i\\in\\{1,2\\},1\\le l_i\\le r_i\\le n$$$) — the $$$i$$$-th operation.",
  "outputFormat": "For each \"2 $$$l$$$ $$$r$$$\", output the answer in an separate line.",
  "sampleTests": [
    {
      "input": "5 4\n8 1 6 3 7\n2 1 5\n2 3 4\n1 1 3\n2 3 4",
      "output": "10\n2\n1"
    }
  ],
  "timeLimit": 3000,
  "memoryLimit": 512,
  "sourceUrl": "https://codeforces.com/problemset/problem/1797/E",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}