{
  "contestId": 1900,
  "index": "E",
  "name": "Transitive Graph",
  "rating": 2100,
  "tags": [
    "implementation"
  ],
  "statement": "You are given a directed graph $$$G$$$ with $$$n$$$ vertices and $$$m$$$ edges between them. Initially, graph $$$H$$$ is the same as graph $$$G$$$. Then you decided to perform the following actions: If there exists a triple of vertices $$$a$$$, $$$b$$$, $$$c$$$ of $$$H$$$, such that there is an edge from $$$a$$$ to $$$b$$$ and an edge from $$$b$$$ to $$$c$$$, but there is no edge from $$$a$$$ to $$$c$$$, add an edge from $$$a$$$ to $$$c$$$. Repeat the previous step as long as there are such triples. Note that the number of edges in $$$H$$$ can be up to $$$n^2$$$ after performing the actions. You also wrote some values on vertices of graph $$$H$$$. More precisely, vertex $$$i$$$ has the value of $$$a_i$$$ written on it. Consider a simple path consisting of $$$k$$$ distinct vertices with indexes $$$v_1, v_2, \\ldots, v_k$$$. The length of such a path is $$$k$$$. The value of that path is defined as $$$\\sum_{i = 1}^k a_{v_i}$$$. A simple path is considered the longest if there is no other simple path in the graph with greater length. Among all the longest simple paths in $$$H$$$, find the one with the smallest value.",
  "inputFormat": "Each test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \\le t \\le 10^4$$$). The description of the test cases follows. The first line of each test case contains two integers $$$n$$$ and $$$m$$$ ($$$1 \\le n,m \\le 2 \\cdot 10^5$$$) — the number of vertices and the number of edges. The second line contains $$$n$$$ integers $$$a_1, a_2, \\ldots, a_n$$$ ($$$0 \\le a_i \\le 10^9$$$) — the numbers written on the vertices of graph $$$H$$$. The $$$i$$$-th of the next $$$m$$$ lines contains two integers $$$v_i$$$ and $$$u_i$$$ ($$$1 \\le v_i, u_i \\le n$$$) — meaning that there is an edge going from vertex $$$v_i$$$ to vertex $$$u_i$$$ in graph $$$G$$$. Note that edges are directed. Also note that the graph may have self-loops and multiple edges. It is guaranteed that neither the sum of $$$n$$$ nor the sum of $$$m$$$ over all test cases exceeds $$$2 \\cdot 10^5$$$.",
  "outputFormat": "For each test case, output two numbers — the length of the longest simple path in $$$H$$$ and the minimal possible value of such path.",
  "sampleTests": [
    {
      "input": "3\n5 6\n2 2 4 1 3\n1 2\n1 3\n2 4\n3 4\n4 5\n5 2\n7 7\n999999999 999999999 999999999 999999999 1000000000 999999999 1000000000\n1 2\n2 3\n3 4\n4 1\n4 5\n4 6\n6 7\n14 22\n2 3 5 7 3 4 1 4 3 4 2 2 5 1\n1 2\n2 3\n2 4\n3 1\n4 4\n4 5\n5 6\n5 6\n5 12\n6 7\n6 8\n7 5\n7 7\n7 9\n8 4\n9 11\n10 9\n11 10\n11 10\n12 13\n13 14\n14 12",
      "output": "5 12\n6 5999999995\n11 37"
    }
  ],
  "timeLimit": 3000,
  "memoryLimit": 256,
  "sourceUrl": "https://codeforces.com/problemset/problem/1900/E",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}