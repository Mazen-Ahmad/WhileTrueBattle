{
  "contestId": 1810,
  "index": "G",
  "name": "The Maximum Prefix",
  "rating": 3200,
  "tags": [
    "implementation"
  ],
  "statement": "You're going to generate an array $$$a$$$ with a length of at most $$$n$$$, where each $$$a_{i}$$$ equals either $$$1$$$ or $$$-1$$$. You generate this array in the following way. First, you choose some integer $$$k$$$ ($$$1\\le k \\le n$$$), which decides the length of $$$a$$$. Then, for each $$$i$$$ ($$$1\\le i \\le k$$$), you set $$$a_{i} = 1$$$ with probability $$$p_{i}$$$, otherwise set $$$a_{i} = -1$$$ (with probability $$$1 - p_{i}$$$). After the array is generated, you calculate $$$s_{i} = a_{1} + a_{2} + a_{3}+ \\ldots + a_{i}$$$. Specially, $$$s_{0} = 0$$$. Then you let $$$S$$$ equal to $$$\\displaystyle \\max_{i=0}^{k}{s_{i}}$$$. That is, $$$S$$$ is the maximum prefix sum of the array $$$a$$$. You are given $$$n+1$$$ integers $$$h_{0} , h_{1}, \\ldots ,h_{n}$$$. The score of an array $$$a$$$ with maximum prefix sum $$$S$$$ is $$$h_{S}$$$. Now, for each $$$k$$$, you want to know the expected score for an array of length $$$k$$$ modulo $$$10^9+7$$$.",
  "inputFormat": "Each test contains multiple test cases. The first line contains a single integer $$$t$$$ ($$$1 \\le t \\le 5000$$$) â€” the number of test cases. Their description follows. The first line contains an integer $$$n$$$ ($$$1\\le n \\le 5000$$$). Then for the following $$$n$$$ lines, each line contains two integers $$$x_{i}$$$ and $$$y_{i}$$$ ($$$0 \\le x_{i} < 10^9 + 7$$$, $$$1\\le y_{i} < 10^9 + 7$$$, $$$x_{i} \\le y_{i}$$$), indicating $$$p_{i} = \\frac{x_{i}}{y_{i}}$$$. The next line contains $$$n+1$$$ integers $$$h_{0},h_{1}, \\ldots, h_{n}$$$ ($$$0 \\le h_{i} < 10^9 + 7$$$). It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$5000$$$.",
  "outputFormat": "For each test case, output $$$n$$$ integers in one single line, the $$$i$$$-th of which denotes the expected score for an array of length $$$i$$$, modulo $$$10^9 + 7$$$. Formally, let $$$M = 10^9 + 7$$$. It can be shown that the answer can be expressed as an irreducible fraction $$$\\frac{p}{q}$$$, where $$$p$$$ and $$$q$$$ are integers and $$$q \\not \\equiv 0 \\pmod{M}$$$. Output the integer equal to $$$p \\cdot q^{-1} \\bmod M$$$. In other words, output such an integer $$$x$$$ that $$$0 \\le x < M$$$ and $$$x \\cdot q \\equiv p \\pmod{M}$$$.",
  "sampleTests": [
    {
      "input": "4\n2\n1 2\n1 2\n1 2 3\n3\n1 3\n1 4\n5 5\n1 1 1 1\n3\n2 5\n4 6\n0 2\n4 3 2 1\n5\n5 6\n5 7\n1 6\n1 3\n4 7\n9 0 4 5 2 4",
      "output": "500000005 750000007 \n1 1 1 \n200000005 333333339 333333339 \n500000005 880952391 801587311 781746041 789304620"
    }
  ],
  "timeLimit": 1000,
  "memoryLimit": 256,
  "sourceUrl": "https://codeforces.com/problemset/problem/1810/G",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}