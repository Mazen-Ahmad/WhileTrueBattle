{
  "contestId": 1868,
  "index": "D",
  "name": "Flower-like Pseudotree",
  "rating": 3000,
  "tags": [
    "implementation"
  ],
  "statement": "A pseudotree is a connected graph which has exactly one cycle and no self-loops. Note that a pseudotree may contain multiple-edges . It can be shown that a pseudotree with $$$n$$$ vertices always contains $$$n$$$ edges. After deleting all edges on the cycle in the pseudotree, a forest$$$^{\\dagger}$$$ will be formed. It can be shown that each tree in the forest will contain exactly one vertex which is on cycle before removing the edges. If all trees in the forest have the same depth$$$^{\\ddagger}$$$ when picking the vertex on cycle as root, we call the original pseudotree flower-like . Our friend sszcdjr, had a flower-like pseudotree with $$$n$$$ vertices and $$$n$$$ edges. However, he forgot all the edges in the pseudotree. Fortunately, he still remembers the degrees of vertices. Specifically, the degree of the $$$i$$$-th vertex is $$$d_i$$$. You have to help sszcdjr construct a possible flower-like pseudotree with $$$n$$$ vertices, where the degree of the $$$i$$$-th vertex is exactly $$$d_i$$$, or tell him that it is impossible. $$$^{\\dagger}$$$ A forest is a graph in which all connectivity components are trees. A connected graph without cycles and self-loops is called a tree. $$$^{\\ddagger}$$$ The depth of a tree with a root is the maximum distance from the root to the vertex of this tree.",
  "inputFormat": "The first line of the input contains a single integer $$$t$$$ ($$$1\\leq t\\leq 10^5$$$) — the number of test cases. The description of test cases follows. The first line of each test case contains a single integer $$$n$$$ ($$$2\\leq n\\leq 10^6$$$) — the number of vertices. The second line of each test case contains $$$n$$$ integers $$$d_1,d_2,\\ldots,d_n$$$ ($$$1\\leq d_i\\leq n$$$) — the degree of each vertex. It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$10^6$$$.",
  "outputFormat": "For each test case, if there exist a possible flower-like pseudotree: Print \" Yes \" (without quotes) in the first line. Then, output $$$n$$$ lines, in each line print two integers $$$u_i$$$ and $$$v_i$$$ — the two vertices that the $$$i$$$-th edge connects. If there are multiple answers, you may output any of them. Otherwise, print \" No \" (without quotes) in the only line of output. You can output the first line of each test case in any case (upper or lower). For example, the strings \" yEs \", \" yes \", \" Yes \", and \" YES \" will be recognized as positive responses.",
  "sampleTests": [
    {
      "input": "6\n3\n2 2 2\n4\n1 2 3 4\n7\n4 3 3 1 1 1 1\n6\n1 1 2 2 3 3\n10\n1 1 5 2 1 1 1 1 1 6\n9\n1 1 3 1 1 4 1 1 5",
      "output": "Yes\n1 2\n2 3\n3 1\nNo\nYes\n1 2\n2 3\n3 1\n1 4\n1 5\n2 6\n3 7\nYes\n5 6\n6 5\n1 3\n2 4\n3 5\n4 6\nNo\nYes\n3 6\n6 9\n9 3\n1 3\n2 6\n4 6\n5 9\n7 9\n8 9"
    }
  ],
  "timeLimit": 3000,
  "memoryLimit": 512,
  "sourceUrl": "https://codeforces.com/problemset/problem/1868/D",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}