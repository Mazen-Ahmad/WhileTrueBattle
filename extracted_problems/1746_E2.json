{
  "contestId": 1746,
  "index": "E2",
  "name": "Joking (Hard Version)",
  "rating": 3200,
  "tags": [
    "implementation"
  ],
  "statement": "The only difference between this problem and the hard version is the maximum number of questions. This is an interactive problem. There is a hidden integer $$$1 \\le x \\le n$$$ which you have to find. In order to find it you can ask at most $$$\\mathbf{53}$$$ questions. In each question you can choose a non-empty integer set $$$S$$$ and ask if $$$x$$$ belongs to $$$S$$$ or not, after each question, if $$$x$$$ belongs to $$$S$$$, you'll receive \" YES \", otherwise \" NO \". But the problem is that not all answers are necessarily true (some of them are joking), it's just guaranteed that for each two consecutive questions, at least one of them is answered correctly. Additionally to the questions, you can make at most $$$2$$$ guesses for the answer $$$x$$$. Each time you make a guess, if you guess $$$x$$$ correctly, you receive \" :) \" and your program should terminate, otherwise you'll receive \" :( \". As a part of the joking, we will not fix the value of $$$x$$$ in the beginning. Instead, it can change throughout the interaction as long as all the previous responses are valid as described above. Note that your answer guesses are always answered correctly. If you ask a question before and after a guess, at least one of these two questions is answered correctly, as normal.",
  "inputFormat": "The only line of the input contains a single integer $$$n$$$ ($$$1 \\le n \\le 10^5$$$), the maximum possible value of $$$x$$$.",
  "outputFormat": "Output specification not found",
  "sampleTests": [
    {
      "input": "6NO:(NO:)",
      "output": "? 5 1 2 5 4 3! 6? 4 1 2 3 4! 5"
    }
  ],
  "timeLimit": 1000,
  "memoryLimit": 256,
  "sourceUrl": "https://codeforces.com/problemset/problem/1746/E2",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}