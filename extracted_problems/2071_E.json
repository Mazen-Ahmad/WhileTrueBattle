{
  "contestId": 2071,
  "index": "E",
  "name": "LeaFall",
  "rating": 2600,
  "tags": [
    "implementation"
  ],
  "statement": "You are given a tree$$$^{\\text{∗}}$$$ with $$$n$$$ vertices. Over time, each vertex $$$i$$$ ($$$1 \\le i \\le n$$$) has a probability of $$$\\frac{p_i}{q_i}$$$ of falling. Determine the expected value of the number of unordered pairs$$$^{\\text{†}}$$$ of distinct vertices that become leaves$$$^{\\text{‡}}$$$ in the resulting forest$$$^{\\text{§}}$$$, modulo $$$998\\,244\\,353$$$. Note that when vertex $$$v$$$ falls, it is removed along with all edges connected to it. However, adjacent vertices remain unaffected by the fall of $$$v$$$. $$$^{\\text{∗}}$$$A tree is a connected graph without cycles. $$$^{\\text{†}}$$$An unordered pair is a collection of two elements where the order in which the elements appear does not matter. For example, the unordered pair $$$(1, 2)$$$ is considered the same as $$$(2, 1)$$$. $$$^{\\text{‡}}$$$A leaf is a vertex that is connected to exactly one edge. $$$^{\\text{§}}$$$A forest is a graph without cycles",
  "inputFormat": "Each test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \\le t \\le 10^4$$$). The description of the test cases follows. The first line of each test case contains a single integer $$$n$$$ ($$$1 \\le n \\le 10^5$$$). The $$$i$$$-th line of the following $$$n$$$ lines contains two integers $$$p_i$$$ and $$$q_i$$$ ($$$1 \\le p_i < q_i < 998\\,244\\,353$$$). Each of the following $$$n - 1$$$ lines contains two integers $$$u$$$ and $$$v$$$ ($$$1 \\le u, v \\le n$$$, $$$u \\neq v$$$) — the indices of the vertices connected by an edge. It is guaranteed that the given edges form a tree. It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$10^5$$$.",
  "outputFormat": "For each test case, output a single integer — the expected value of the number of unordered pairs of distinct vertices that become leaves in the resulting forest modulo $$$998\\,244\\,353$$$. Formally, let $$$M = 998\\,244\\,353$$$. It can be shown that the exact answer can be expressed as an irreducible fraction $$$\\frac{p}{q}$$$, where $$$p$$$ and $$$q$$$ are integers and $$$q \\not \\equiv 0 \\pmod{M}$$$. Output the integer equal to $$$p \\cdot q^{-1} \\bmod M$$$. In other words, output such an integer $$$x$$$ that $$$0 \\le x < M$$$ and $$$x \\cdot q \\equiv p \\pmod{M}$$$.",
  "sampleTests": [
    {
      "input": "5\n1\n1 2\n3\n1 2\n1 2\n1 2\n1 2\n2 3\n3\n1 3\n1 5\n1 3\n1 2\n2 3\n1\n998244351 998244352\n6\n10 17\n7 13\n6 11\n2 10\n10 19\n5 13\n4 3\n3 6\n1 4\n3 5\n3 2",
      "output": "0\n623902721\n244015287\n0\n799215919"
    }
  ],
  "timeLimit": 3000,
  "memoryLimit": 512,
  "sourceUrl": "https://codeforces.com/problemset/problem/2071/E",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}