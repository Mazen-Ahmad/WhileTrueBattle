{
  "contestId": 1857,
  "index": "G",
  "name": "Counting Graphs",
  "rating": 2000,
  "tags": [
    "implementation"
  ],
  "statement": "Given a tree consisting of $$$n$$$ vertices. A tree is a connected undirected graph without cycles. Each edge of the tree has its weight, $$$w_i$$$. Your task is to count the number of different graphs that satisfy all four conditions: The graph does not have self-loops and multiple edges. The weights on the edges of the graph are integers and do not exceed $$$S$$$. The graph has exactly one minimum spanning tree . The minimum spanning tree of the graph is the given tree. Two graphs are considered different if their sets of edges are different, taking into account the weights of the edges. The answer can be large, output it modulo $$$998244353$$$.",
  "inputFormat": "The first line contains an integer $$$t$$$ ($$$1\\le t\\le 10^4$$$) — the number of test cases. The first line of each test case contains two integers $$$n$$$ and $$$S$$$ ($$$2 \\le n \\le 2 \\cdot 10^5, 1\\le S\\le 10^9$$$) — the number of vertices and the upper bound of the weights. Then follow $$$n-1$$$ lines describing the tree, the $$$i$$$-th line contains three integers $$$u_i$$$, $$$v_i$$$, and $$$w_i$$$ ($$$1\\le u_i,v_i\\le n, u_i \\ne v_i, 1\\le w_i\\le S$$$) — an edge in the tree with weight $$$w_i$$$. It is guaranteed that the sum of $$$n$$$ for all tests does not exceed $$$2\\cdot 10^5$$$.",
  "outputFormat": "For each test, output the number of different graphs that satisfy the conditions, modulo $$$998244353$$$.",
  "sampleTests": [
    {
      "input": "4\n2 5\n1 2 4\n4 5\n1 2 2\n2 3 4\n3 4 3\n5 6\n1 2 3\n1 3 2\n3 4 6\n3 5 1\n10 200\n1 2 3\n2 3 33\n3 4 200\n1 5 132\n5 6 1\n5 7 29\n7 8 187\n7 9 20\n7 10 4",
      "output": "1\n8\n80\n650867886"
    }
  ],
  "timeLimit": 2000,
  "memoryLimit": 256,
  "sourceUrl": "https://codeforces.com/problemset/problem/1857/G",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}