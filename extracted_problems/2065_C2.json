{
  "contestId": 2065,
  "index": "C2",
  "name": "Skibidus and Fanum Tax (hard version)",
  "rating": 1300,
  "tags": [
    "implementation"
  ],
  "statement": "This is the hard version of the problem. In this version, $$$m \\leq 2\\cdot 10^5$$$. Skibidus has obtained two arrays $$$a$$$ and $$$b$$$, containing $$$n$$$ and $$$m$$$ elements respectively. For each integer $$$i$$$ from $$$1$$$ to $$$n$$$, he is allowed to perform the operation at most once : Choose an integer $$$j$$$ such that $$$1 \\leq j \\leq m$$$. Set $$$a_i := b_j - a_i$$$. Note that $$$a_i$$$ may become non-positive as a result of this operation. Skibidus needs your help determining whether he can sort $$$a$$$ in non-decreasing order$$$^{\\text{∗}}$$$ by performing the above operation some number of times. $$$^{\\text{∗}}$$$$$$a$$$ is sorted in non-decreasing order if $$$a_1 \\leq a_2 \\leq \\ldots \\leq a_n$$$.",
  "inputFormat": "The first line contains an integer $$$t$$$ ($$$1 \\leq t \\leq 10^4$$$) — the number of test cases. The first line of each test case contains two integers $$$n$$$ and $$$m$$$ ($$$1 \\leq n \\leq 2 \\cdot 10^5$$$, $$$1 \\leq m \\leq 2\\cdot 10^5$$$). The following line of each test case contains $$$n$$$ integers $$$a_1, a_2, \\ldots, a_n$$$ ($$$1 \\leq a_i \\leq 10^9$$$). The following line of each test case contains $$$m$$$ integers $$$b_1, b_2, \\ldots, b_m$$$ ($$$1 \\leq b_i \\leq 10^9$$$). It is guaranteed that the sum of $$$n$$$ and the sum of $$$m$$$ over all test cases does not exceed $$$2 \\cdot 10^5$$$.",
  "outputFormat": "For each test case, if it is possible to sort $$$a$$$ in non-decreasing order, print \" YES \" on a new line. Otherwise, print \" NO \" on a new line. You can output the answer in any case. For example, the strings \" yEs \", \" yes \", and \" Yes \" will also be recognized as positive responses.",
  "sampleTests": [
    {
      "input": "5\n1 3\n5\n9 1 1000000000\n3 2\n1 4 3\n3 4\n4 3\n2 4 6 5\n6 1 8\n5 2\n6 4 5 4 5\n4 1000\n3 1\n9 8 7\n8",
      "output": "YES\nNO\nYES\nNO\nYES"
    }
  ],
  "timeLimit": 2000,
  "memoryLimit": 256,
  "sourceUrl": "https://codeforces.com/problemset/problem/2065/C2",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}