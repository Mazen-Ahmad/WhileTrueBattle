{
  "contestId": 1898,
  "index": "F",
  "name": "Vova Escapes the Matrix",
  "rating": 2600,
  "tags": [
    "implementation"
  ],
  "statement": "Following a world tour, Vova got himself trapped inside an $$$n \\times m$$$ matrix. Rows of this matrix are numbered by integers from $$$1$$$ to $$$n$$$ from top to bottom, and the columns are numbered by integers from $$$1$$$ to $$$m$$$ from left to right. The cell $$$(i, j)$$$ is the cell on the intersection of row $$$i$$$ and column $$$j$$$ for $$$1 \\leq i \\leq n$$$ and $$$1 \\leq j \\leq m$$$. Some cells of this matrix are blocked by obstacles, while all other cells are empty. Vova occupies one of the empty cells. It is guaranteed that cells $$$(1, 1)$$$, $$$(1, m)$$$, $$$(n, 1)$$$, $$$(n, m)$$$ (that is, corners of the matrix) are blocked. Vova can move from one empty cell to another empty cell if they share a side. Vova can escape the matrix from any empty cell on the boundary of the matrix; these cells are called exits . Vova defines the type of the matrix based on the number of exits he can use to escape the matrix: The $$$1$$$-st type: matrices with no exits he can use to escape. The $$$2$$$-nd type: matrices with exactly one exit he can use to escape. The $$$3$$$-rd type: matrices with multiple (two or more) exits he can use to escape. Before Vova starts moving, Misha can create more obstacles to block more cells. However, he cannot change the type of the matrix. What is the maximum number of cells Misha can block, so that the type of the matrix remains the same? Misha cannot block the cell Vova is currently standing on.",
  "inputFormat": "Each test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \\leq t \\leq 10\\,000$$$). The description of test cases follows. The first line of each test case contains two integers $$$n$$$ and $$$m$$$ ($$$3 \\leq n,m \\leq 1000$$$) — the dimensions of the matrix. The next $$$n$$$ lines contain the description of the matrix: the $$$i$$$-th ($$$1 \\le i \\le n$$$) of them contains a string of length $$$m$$$, consisting of characters ' . ', ' # ', and ' V '. The $$$j$$$-th character of the $$$i$$$-th line describes the cell $$$(i, j)$$$ of the matrix. The dot ' . ' denotes an empty cell, the sharp ' # ' denotes a blocked cell, and the letter ' V ' denotes an empty cell where Vova initially is. It is guaranteed that the corners of the matrix are blocked (the first and the last characters of the first and the last lines of the matrix description are ' # '). It is guaranteed that the letter ' V ' appears in the matrix description exactly once. It is guaranteed that the sum of $$$n \\cdot m$$$ over all test cases does not exceed $$$1\\,000\\,000$$$.",
  "outputFormat": "For each test case, output a single integer — the maximum number of cells Misha may block.",
  "sampleTests": [
    {
      "input": "8\n4 4\n#..#\n..V.\n....\n#..#\n3 6\n#.####\n#....#\n####V#\n3 3\n###\n#V#\n###\n6 5\n#.###\n#...#\n###.#\n#V..#\n#.###\n##..#\n7 5\n#####\n#.V.#\n#.#.#\n#.#.#\n#.#.#\n#...#\n#.#.#\n3 7\n#.....#\n.#####.\n#...V.#\n5 8\n####.###\n#..V#..#\n#...#..#\n#...##.#\n###.####\n5 5\n#...#\n##.##\n##V##\n##.##\n#...#",
      "output": "9\n0\n0\n3\n4\n10\n12\n5"
    }
  ],
  "timeLimit": 2000,
  "memoryLimit": 256,
  "sourceUrl": "https://codeforces.com/problemset/problem/1898/F",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}