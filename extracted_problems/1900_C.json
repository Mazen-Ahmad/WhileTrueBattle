{
  "contestId": 1900,
  "index": "C",
  "name": "Anji's Binary Tree",
  "rating": 1300,
  "tags": [
    "implementation"
  ],
  "statement": "Keksic keeps getting left on seen by Anji. Through a mutual friend, he's figured out that Anji really likes binary trees and decided to solve her problem in order to get her attention. Anji has given Keksic a binary tree with $$$n$$$ vertices. Vertex $$$1$$$ is the root and does not have a parent. All other vertices have exactly one parent. Each vertex can have up to $$$2$$$ children, a left child, and a right child. For each vertex, Anji tells Keksic index of both its left and its right child or tells him that they do not exist. Additionally, each of the vertices has a letter $$$s_i$$$ on it, which is either ' U ', ' L ' or ' R '. Keksic begins his journey on the root, and in each move he does the following: If the letter on his current vertex is ' U ', he moves to its parent. If it doesn't exist, he does nothing. If the letter on his current vertex is ' L ', he moves to its left child. If it doesn't exist, he does nothing. If the letter on his current vertex is ' R ', he moves to its right child. If it doesn't exist, he does nothing. Before his journey, he can perform the following operations: choose any node, and replace the letter written on it with another one. You are interested in the minimal number of operations he needs to do before his journey, such that when he starts his journey, he will reach a leaf at some point. A leaf is a vertex that has no children. It does not matter which leaf he reaches. Note that it does not matter whether he will stay in the leaf, he just needs to move to it. Additionally, note that it does not matter how many times he needs to move before reaching a leaf. Help Keksic solve Anji's tree so that he can win her heart, and make her come to Čačak.",
  "inputFormat": "Each test consists of multiple test cases. The first line contains a single integer $$$t$$$ ($$$1 \\le t \\le 5 \\cdot 10^4$$$) — the number of test cases. The description of test cases follows. The first line of each test case contains a single integer $$$n$$$ ($$$2 \\le n \\le 3 \\cdot 10^5$$$) — the number of vertices in a tree. The second line of each test case contains a string $$$s$$$ of $$$n$$$ characters — characters are written on the vertices. It is guaranteed that $$$s$$$ consists only of characters ' U ', ' L ', and ' R '. The $$$i$$$-th of the next $$$n$$$ lines contains two integers $$$l_i$$$ and $$$r_i$$$ ($$$0 \\le l_i, r_i \\le n$$$) — indices of left and right child of the vertex $$$i$$$. If $$$l_i = 0$$$, it means that vertex $$$i$$$ does not have a left child. If $$$r_i = 0$$$, it means that vertex $$$i$$$ does not have a right child. It is guaranteed that this data describes a valid binary tree rooted at $$$1$$$. It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$3 \\cdot 10^5$$$.",
  "outputFormat": "For each test case, output a single integer — the minimal number of operations Keksic needs to do to reach a leaf.",
  "sampleTests": [
    {
      "input": "5\n3\nLRU\n2 3\n0 0\n0 0\n3\nULR\n3 2\n0 0\n0 0\n2\nLU\n0 2\n0 0\n4\nRULR\n3 0\n0 0\n0 4\n2 0\n7\nLLRRRLU\n5 2\n3 6\n0 0\n7 0\n4 0\n0 0\n0 0",
      "output": "0\n1\n1\n3\n1"
    }
  ],
  "timeLimit": 2500,
  "memoryLimit": 256,
  "sourceUrl": "https://codeforces.com/problemset/problem/1900/C",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}