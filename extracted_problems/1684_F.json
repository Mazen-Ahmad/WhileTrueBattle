{
  "contestId": 1684,
  "index": "F",
  "name": "Diverse Segments",
  "rating": 2600,
  "tags": [
    "implementation"
  ],
  "statement": "You are given an array $$$a$$$ of $$$n$$$ integers. Also you are given $$$m$$$ subsegments of that array. The left and the right endpoints of the $$$j$$$-th segment are $$$l_j$$$ and $$$r_j$$$ respectively. You are allowed to make no more than one operation. In that operation you choose any subsegment of the array $$$a$$$ and replace each value on this segment with any integer (you are also allowed to keep elements the same). You have to apply this operation so that for the given $$$m$$$ segments, the elements on each segment are distinct. More formally, for each $$$1 \\le j \\le m$$$ all elements $$$a_{l_{j}}, a_{l_{j}+1}, \\ldots, a_{r_{j}-1}, a_{r_{j}}$$$ should be distinct. You don't want to use the operation on a big segment, so you have to find the smallest length of a segment, so that you can apply the operation to this segment and meet the above-mentioned conditions. If it is not needed to use this operation, the answer is $$$0$$$.",
  "inputFormat": "The input consists of multiple test cases. The first line contains a single integer $$$t$$$ ($$$1 \\le t \\le 100$$$) — the number of test cases. Description of the test cases follows. The first line of each test case contains two integers $$$n$$$ and $$$m$$$ ($$$1 \\le n, m \\le 2 \\cdot 10^5$$$) — the size of the array and the number of segments respectively. The next line contains $$$n$$$ integers $$$a_1, a_2, \\ldots, a_n$$$ ($$$1 \\le a_i \\le 10^9$$$) — the elements of $$$a$$$. Each of the next $$$m$$$ lines contains two integers $$$l_j$$$, $$$r_j$$$ ($$$1 \\le l_j \\le r_j \\le n$$$) — the left and the right endpoints of the $$$j$$$-th segment. It's guaranteed that the sum of $$$n$$$ and the sum of $$$m$$$ over all test cases does not exceed $$$2 \\cdot 10^5$$$.",
  "outputFormat": "For each test case output a single integer — the smallest length of a segment you can apply an operation on making the elements on all given segments distinct. If it is not needed to use the operation, output $$$0$$$.",
  "sampleTests": [
    {
      "input": "5\n7 3\n1 1 2 1 3 3 5\n1 4\n4 5\n2 4\n5 2\n10 1 6 14 1\n4 5\n2 4\n4 5\n5 7 5 6\n2 2\n1 3\n2 4\n3 3\n3 4\n7 3\n2 2 2 7 8 2 2\n4 4\n4 4\n5 5\n1 1\n123\n1 1",
      "output": "2\n0\n1\n0\n0"
    }
  ],
  "timeLimit": 2000,
  "memoryLimit": 256,
  "sourceUrl": "https://codeforces.com/problemset/problem/1684/F",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}