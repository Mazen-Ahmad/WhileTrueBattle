{
  "contestId": 1707,
  "index": "E",
  "name": "Replace",
  "rating": 3500,
  "tags": [
    "implementation"
  ],
  "statement": "You are given an integer array $$$a_1,\\ldots, a_n$$$, where $$$1\\le a_i \\le n$$$ for all $$$i$$$. There's a \"replace\" function $$$f$$$ which takes a pair of integers $$$(l, r)$$$, where $$$l \\le r$$$, as input and outputs the pair $$$$$$f\\big( (l, r) \\big)=\\left(\\min\\{a_l,a_{l+1},\\ldots,a_r\\},\\, \\max\\{a_l,a_{l+1},\\ldots,a_r\\}\\right).$$$$$$ Consider repeated calls of this function. That is, from a starting pair $$$(l, r)$$$ we get $$$f\\big((l, r)\\big)$$$, then $$$f\\big(f\\big((l, r)\\big)\\big)$$$, then $$$f\\big(f\\big(f\\big((l, r)\\big)\\big)\\big)$$$, and so on. Now you need to answer $$$q$$$ queries. For the $$$i$$$-th query you have two integers $$$l_i$$$ and $$$r_i$$$ ($$$1\\le l_i\\le r_i\\le n$$$). You must answer the minimum number of times you must apply the \"replace\" function to the pair $$$(l_i,r_i)$$$ to get $$$(1, n)$$$, or report that it is impossible.",
  "inputFormat": "The first line contains two positive integers $$$n$$$, $$$q$$$ ($$$1\\le n,q\\le 10^5$$$) — the length of the sequence $$$a$$$ and the number of the queries. The second line contains $$$n$$$ positive integers $$$a_1,a_2,\\ldots,a_n$$$ ($$$1\\le a_i\\le n$$$) — the sequence $$$a$$$. Each line of the following $$$q$$$ lines contains two integers $$$l_i$$$, $$$r_i$$$ ($$$1\\le l_i\\le r_i\\le n$$$) — the queries.",
  "outputFormat": "For each query, output the required number of times, or $$$-1$$$ if it is impossible.",
  "sampleTests": [
    {
      "input": "5 6\n2 5 4 1 3\n4 4\n1 5\n1 4\n3 5\n4 5\n2 3",
      "output": "-1\n0\n1\n2\n3\n4"
    }
  ],
  "timeLimit": 1500,
  "memoryLimit": 1024,
  "sourceUrl": "https://codeforces.com/problemset/problem/1707/E",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}