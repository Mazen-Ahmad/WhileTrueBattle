{
  "contestId": 1515,
  "index": "I",
  "name": "Phoenix and Diamonds",
  "rating": 3400,
  "tags": [
    "implementation"
  ],
  "statement": "Phoenix wonders what it is like to rob diamonds from a jewelry store! There are $$$n$$$ types of diamonds. The $$$i$$$-th type has weight $$$w_i$$$ and value $$$v_i$$$. The store initially has $$$a_i$$$ diamonds of the $$$i$$$-th type. Each day, for $$$q$$$ days, one of the following will happen: A new shipment of $$$k_i$$$ diamonds of type $$$d_i$$$ arrive. The store sells $$$k_i$$$ diamonds of type $$$d_i$$$. Phoenix wonders what will happen if he robs the store using a bag that can fit diamonds with total weight not exceeding $$$c_i$$$. If he greedily takes diamonds of the largest value that fit, how much value would be taken? If there are multiple diamonds with the largest value, he will take the one with minimum weight. If, of the diamonds with the largest value, there are multiple with the same minimum weight, he will take any of them. Of course, since Phoenix is a law-abiding citizen, this is all a thought experiment and he never actually robs any diamonds from the store. This means that queries of type $$$3$$$ do not affect the diamonds in the store.",
  "inputFormat": "The first line contains two integers $$$n$$$ and $$$q$$$ ($$$1 \\le n \\le 2 \\cdot 10^5$$$; $$$1 \\le q \\le 10^5$$$) — the number of types of diamonds and number of days, respectively. The next $$$n$$$ lines describe each type of diamond. The $$$i$$$-th line will contain three integers $$$a_i$$$, $$$w_i$$$, and $$$v_i$$$ ($$$0 \\le a_i \\le 10^5$$$; $$$1 \\le w_i, v_i \\le 10^5$$$) — the initial number of diamonds of the $$$i$$$-th type, the weight of diamonds of the $$$i$$$-th type, and the value of diamonds of the $$$i$$$-th type, respectively. The next $$$q$$$ lines contain the queries. For each query, the first integer of each line is $$$t$$$ ($$$1 \\le t \\le 3$$$) — the type of query. If $$$t=1$$$, then two integers $$$k_i$$$, $$$d_i$$$ follow ($$$1 \\le k_i \\le 10^5$$$; $$$1 \\le d_i \\le n$$$). This means that a new shipment of $$$k_i$$$ diamonds arrived, each of type $$$d_i$$$. If $$$t=2$$$, then two integers $$$k_i$$$, $$$d_i$$$ follow ($$$1 \\le k_i \\le 10^5$$$; $$$1 \\le d_i \\le n$$$). This means that the store has sold $$$k_i$$$ diamonds, each of type $$$d_i$$$. It is guaranteed that the store had the diamonds before they sold them. If $$$t=3$$$, an integer $$$c_i$$$ will follow ($$$1 \\le c_i \\le 10^{18}$$$) — the weight capacity of Phoenix's bag. It is guaranteed that there is at least one query where $$$t=3$$$.",
  "outputFormat": "Print the answer for each query of the third type ($$$t=3$$$).",
  "sampleTests": [
    {
      "input": "3 5\n2 3 4\n1 5 1\n0 2 4\n3 6\n1 3 3\n3 10\n2 2 3\n3 30",
      "output": "8\n16\n13"
    }
  ],
  "timeLimit": 5000,
  "memoryLimit": 1024,
  "sourceUrl": "https://codeforces.com/problemset/problem/1515/I",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}