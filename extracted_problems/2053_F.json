{
  "contestId": 2053,
  "index": "F",
  "name": "Earnest Matrix Complement",
  "rating": 2600,
  "tags": [
    "implementation"
  ],
  "statement": "3, 2, 1, ... We are the — RiOI Team! — Felix & All, Special Thanks 3 Peter: Good news: My problem T311013 is approved! $$$\\delta$$$: I'm glad my computer had gone out of battery so that I wouldn't have participated in wyrqwq's round and gained a negative delta. Felix: [thumbs_up] The problem statement concerning a removed song! Aquawave: Do I mourn my Chemistry? E.Space: ahh? Trine: Bread. Iris: So why am I always testing problems? Time will pass, and we might meet again. Looking back at the past, everybody has lived the life they wanted. Aquawave has a matrix $$$A$$$ of size $$$n\\times m$$$, whose elements can only be integers in the range $$$[1, k]$$$, inclusive. In the matrix, some cells are already filled with an integer, while the rest are currently not filled, denoted by $$$-1$$$. You are going to fill in all the unfilled places in $$$A$$$. After that, let $$$c_{u,i}$$$ be the number of occurrences of element $$$u$$$ in the $$$i$$$-th row. Aquawave defines the beauty of the matrix as $$$$$$\\sum_{u=1}^k \\sum_{i=1}^{n-1} c_{u,i} \\cdot c_{u,i+1}.$$$$$$ You have to find the maximum possible beauty of $$$A$$$ after filling in the blanks optimally.",
  "inputFormat": "The first line of input contains a single integer $$$t$$$ ($$$1 \\leq t \\leq 2\\cdot 10^4$$$) — the number of test cases. The description of test cases follows. The first line of each test case contains three integers $$$n$$$, $$$m$$$, and $$$k$$$ ($$$2 \\leq n \\leq 2\\cdot 10^5$$$, $$$2 \\leq m \\leq 2\\cdot 10^5$$$, $$$n \\cdot m \\leq 6\\cdot 10^5$$$, $$$1 \\leq k \\leq n\\cdot m$$$) — the number of rows and columns of the matrix $$$A$$$, and the range of the integers in the matrix, respectively. Then $$$n$$$ lines follow, the $$$i$$$-th line containing $$$m$$$ integers $$$A_{i,1},A_{i,2},\\ldots,A_{i,m}$$$ ($$$1 \\leq A_{i,j} \\leq k$$$ or $$$A_{i,j} = -1$$$) — the elements in $$$A$$$. It is guaranteed that the sum of $$$n\\cdot m$$$ over all test cases does not exceed $$$6\\cdot 10^5$$$.",
  "outputFormat": "For each test case, output a single integer — the maximum possible beauty.",
  "sampleTests": [
    {
      "input": "9\n3 3 3\n1 2 2\n3 1 3\n3 2 1\n2 3 3\n-1 3 3\n2 2 -1\n3 3 6\n-1 -1 1\n1 2 -1\n-1 -1 4\n3 4 5\n1 3 2 3\n-1 -1 2 -1\n3 1 5 1\n5 3 8\n5 -1 2\n1 8 -1\n-1 5 6\n7 7 -1\n4 4 4\n6 6 5\n-1 -1 5 -1 -1 -1\n-1 -1 -1 -1 2 -1\n-1 1 3 3 -1 -1\n-1 1 -1 -1 -1 4\n4 2 -1 -1 -1 4\n-1 -1 1 2 -1 -1\n6 6 4\n-1 -1 -1 -1 1 -1\n3 -1 2 2 4 -1\n3 1 2 2 -1 -1\n3 3 3 3 -1 2\n-1 3 3 -1 1 3\n3 -1 2 2 3 -1\n5 5 3\n1 1 3 -1 1\n2 2 -1 -1 3\n-1 -1 -1 2 -1\n3 -1 -1 -1 2\n-1 1 2 3 -1\n6 2 7\n-1 7\n-1 6\n7 -1\n-1 -1\n-1 -1\n2 2",
      "output": "4\n4\n10\n10\n8\n102\n93\n58\n13"
    }
  ],
  "timeLimit": 5000,
  "memoryLimit": 512,
  "sourceUrl": "https://codeforces.com/problemset/problem/2053/F",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}