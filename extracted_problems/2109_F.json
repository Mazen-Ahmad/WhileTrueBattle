{
  "contestId": 2109,
  "index": "F",
  "name": "Penguin Steps",
  "rating": 3000,
  "tags": [
    "implementation"
  ],
  "statement": "Mouf, the clever master of Darkness, and Fouad, the brave champion of Light, have entered the Grid Realm once more. This time, they have found the exit, but it is guarded by fierce monsters! They must fight with their bare hands instead of summoning monsters! Mouf and Fouad are standing on an $$$n \\times n$$$ grid. Each cell $$$(i, j)$$$ has a value $$$a_{i,j}$$$ and a color. The color of a cell is white if $$$c_{i,j} = 0$$$ and black if $$$c_{i,j} = 1$$$. Mouf starts at the top-left corner $$$(1, 1)$$$, and Fouad starts at the bottom-left corner $$$(n, 1)$$$. Both are trying to reach the exit cell at $$$(r, n)$$$. A path is defined as a sequence of adjacent cells (sharing a horizontal or vertical edge). The cost of a path is the maximum value of $$$a_{i, j}$$$ among all cells included in the path (including the first and last cells). Let: $$$\\mathrm{dis}_M$$$ denote the minimum possible cost of a valid path from Mouf's starting position $$$(1, 1)$$$ to the exit $$$(r, n)$$$; $$$\\mathrm{dis}_F$$$ denote the minimum possible cost of a valid path from Fouad's starting position $$$(n, 1)$$$ to the exit $$$(r, n)$$$. Before moving, Mouf can perform up to $$$k$$$ operations. In each operation, he may select any black cell and increment its value by $$$1$$$ (possibly choosing the same cell multiple times). Mouf wants to maximize $$$\\mathrm{dis}_F$$$ while ensuring that his own cost $$$\\mathrm{dis}_M$$$ remains unchanged (as if he performed no operations). If Mouf acts optimally, what are the values of $$$\\mathrm{dis}_M$$$ and $$$\\mathrm{dis}_F$$$?",
  "inputFormat": "Each test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \\le t \\le 10^3$$$). The description of the test cases follows. The first line of each test case contains three integers $$$n$$$, $$$r$$$, and $$$k$$$ ($$$2 \\le n \\le 300$$$, $$$1 \\le r \\le n$$$, $$$0 \\le k \\le 10^6$$$) — the length of the grid, the row number of the exit cell, and the number of allowed operations. The $$$i$$$-th of the next $$$n$$$ lines contains $$$n$$$ integers $$$a_{i,1}, a_{i,2}, \\ldots, a_{i,n}$$$ ($$$1 \\le a_{ij} \\le 10^6$$$) — the values of the cells in the $$$i$$$-th row. The $$$i$$$-th of the next $$$n$$$ lines contains a binary string $$$c_i$$$ of length $$$n$$$ — denoting the color of the cells in the $$$i$$$-th row (cell $$$(i,j)$$$ is white if $$$c_{i,j}=\\mathtt{0}$$$ and black if $$$c_{i,j} = \\mathtt{1}$$$). It is guaranteed that the sum of $$$n^2$$$ over all test cases does not exceed $$$9 \\cdot 10^4$$$.",
  "outputFormat": "For each test case, output two integers — $$$\\mathrm{dis}_M$$$ and $$$\\mathrm{dis}_F$$$ if Mouf performs the operations optimally.",
  "sampleTests": [
    {
      "input": "4\n2 1 30\n2 2\n1 1\n11\n01\n3 3 5\n9 2 2\n2 3 2\n2 2 2\n111\n111\n010\n7 3 12\n3 3 3 3 5 1 1\n9 4 8 3 3 5 5\n9 4 8 7 3 3 3\n4 4 4 4 9 4 9\n4 4 4 4 9 4 9\n1 4 4 4 4 4 9\n1 1 4 4 9 9 9\n1111111\n1011111\n1011111\n1111111\n1111101\n1110001\n0111111\n5 3 1419\n1219 678 1672 1858 1210\n535 732 1316 345 296\n1106 3060 507 216 1943\n194 2124 47 87 4818\n1007 329 1425 284 660\n00010\n10111\n00101\n10001\n10100",
      "output": "2 2\n9 5\n3 8\n1943 2426"
    }
  ],
  "timeLimit": 3000,
  "memoryLimit": 512,
  "sourceUrl": "https://codeforces.com/problemset/problem/2109/F",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}