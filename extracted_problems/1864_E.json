{
  "contestId": 1864,
  "index": "E",
  "name": "Guess Game",
  "rating": 2100,
  "tags": [
    "implementation"
  ],
  "statement": "Carol has a sequence $$$s$$$ of $$$n$$$ non-negative integers. She wants to play the \"Guess Game\" with Alice and Bob. To play the game, Carol will randomly select two integer indices $$$i_a$$$ and $$$i_b$$$ within the range $$$[1, n]$$$, and set $$$a=s_{i_a}$$$, $$$b=s_{i_b}$$$. Please note that $$$i_a$$$ and $$$i_b$$$ may coincide. Carol will tell: the value of $$$a$$$ to Alice; the value of $$$b$$$ to Bob; the value of $$$a \\mid b$$$ to both Alice and Bob, where $$$|$$$ denotes the bitwise OR operation . Please note that Carol will not tell any information about $$$s$$$ to either Alice or Bob. Then the guessing starts. The two players take turns making guesses, with Alice starting first. The goal of both players is to establish which of the following is true: $$$a < b$$$, $$$a > b$$$, or $$$a = b$$$. In their turn, a player can do one of the following two things: say \"I don't know\", and pass the turn to the other player; say \"I know\", followed by the answer \"$$$a<b$$$\", \"$$$a>b$$$\", or \"$$$a=b$$$\"; then the game ends. Alice and Bob hear what each other says, and can use this information to deduce the answer. Both Alice and Bob are smart enough and only say \"I know\" when they are completely sure. You need to calculate the expected value of the number of turns taken by players in the game. Output the answer modulo $$$998\\,244\\,353$$$. Formally, let $$$M = 998\\,244\\,353$$$. It can be shown that the answer can be expressed as an irreducible fraction $$$\\frac{p}{q}$$$, where $$$p$$$ and $$$q$$$ are integers and $$$q \\not \\equiv 0 \\pmod{M}$$$. Output the integer equal to $$$p \\cdot q^{-1} \\bmod M$$$. In other words, output such an integer $$$x$$$ that $$$0 \\le x < M$$$ and $$$x \\cdot q \\equiv p \\pmod{M}$$$.",
  "inputFormat": "Each test contains multiple test cases. The first line contains the number of test cases $$$t$$$ ($$$1 \\le t \\le 10^5$$$). The description of the test cases follows. The first line of each testcase contains a single integer $$$n$$$ ($$$1 \\le n \\le 2\\cdot 10^5$$$). The second line of each testcase contains $$$n$$$ integers $$$s_1,s_2,\\ldots, s_n$$$ ($$$0 \\le s_i < 2^{30}$$$). It is guaranteed that the sum of $$$n$$$ over all test cases does not exceed $$$2 \\cdot 10^5$$$.",
  "outputFormat": "For each test case, print a single integer â€” the answer to the problem modulo $$$998\\,244\\,353$$$.",
  "sampleTests": [
    {
      "input": "4\n2\n2 3\n3\n0 0 0\n3\n9 9 6\n8\n34124838 0 113193378 8 321939321 113193378 9463828 99",
      "output": "499122179\n1\n332748120\n77987843"
    }
  ],
  "timeLimit": 3000,
  "memoryLimit": 256,
  "sourceUrl": "https://codeforces.com/problemset/problem/1864/E",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}