{
  "contestId": 1801,
  "index": "G",
  "name": "A task for substrings",
  "rating": 3400,
  "tags": [
    "implementation"
  ],
  "statement": "Philip is very fond of tasks on the lines. He had already solved all the problems known to him, but this was not enough for him. Therefore, Philip decided to come up with his own task. To do this, he took the string $$$t$$$ and a set of $$$n$$$ strings $$$s_1$$$, $$$s_2$$$, $$$s_3$$$, ..., $$$s_n$$$. Philip has $$$m$$$ queries, in the $$$i$$$th of them, Philip wants to take a substring of the string $$$t$$$ from $$$l_i$$$th to $$$r_i$$$th character, and count the number of its substrings that match some string from the set. More formally, Philip wants to count the number of pairs of positions $$$a$$$, $$$b$$$, such that $$$l_i \\le a \\le b \\le r_i$$$, and the substring of the string $$$t$$$ from $$$a$$$th to $$$b$$$th character coincides with some string $$$s_j$$$ from the set. A substring of the string $$$t$$$ from $$$a$$$th to $$$b$$$th character is a string obtained from $$$t$$$ by removing the $$$a - 1$$$ character from the beginning and $$$|t| - b$$$ characters from the end, where $$$|t|$$$ denotes the length of the string $$$t$$$. Philip has already solved this problem, but can you?",
  "inputFormat": "The first line contains two positive integers $$$n$$$ and $$$m$$$ ($$$1 \\le n, m \\le 500\\,000$$$) — the number of rows in the set and the number of queries. The second line contains a single string $$$t$$$ consisting of lowercase letters of the English alphabet ($$$1 \\le |t| \\le 5 \\cdot 10^6$$$). The following $$$n$$$ lines describe the strings from the set. In the $$$i$$$th of them, a single string $$$s_i$$$ is given, consisting of lowercase letters of the English alphabet. Denote by $$$S$$$ the total length of all strings from the set. It is guaranteed that $$$S \\le 10^6$$$, as well as that all strings of $$$s_i$$$ are different. In the following lines, queries are entered. The $$$i$$$th of them contains two positive integers $$$l_i$$$ and $$$r_i$$$ ($$$1 \\le l_i \\le r_i \\le |t|$$$) — the left and right border of the substring $$$t$$$ from the $$$i$$$-th query.",
  "outputFormat": "In a single line, print $$$m$$$ integers, $$$i$$$th of them should be equal to the answers to the $$$i$$$th query.",
  "sampleTests": [
    {
      "input": "3 5\nabacaba\naba\na\nac\n1 7\n1 3\n2 7\n2 5\n4 5",
      "output": "7 3 5 3 1"
    }
  ],
  "timeLimit": 4000,
  "memoryLimit": 1024,
  "sourceUrl": "https://codeforces.com/problemset/problem/1801/G",
  "verified": true,
  "qualityScore": 4.0,
  "source": "codeforces-scraped"
}